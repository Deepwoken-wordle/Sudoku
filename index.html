<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Satunnainen Sudoku</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f5f5f5;
    }

    h1 {
        margin-top: 20px;
    }

    table {
        border-collapse: collapse;
        margin: 20px auto;
    }

    td {
        width: 40px;
        height: 40px;
        border: 1px solid #444;
        font-size: 20px;
        text-align: center;
        vertical-align: middle;
        background: white;
    }

    /* Thicker borders for 3x3 blocks */
    tr:nth-child(3n) td {
        border-bottom: 2px solid black;
    }
    td:nth-child(3n) {
        border-right: 2px solid black;
    }
    tr:first-child td {
        border-top: 2px solid black;
    }
    td:first-child {
        border-left: 2px solid black;
    }

    select, button {
        padding: 8px 12px;
        margin: 10px;
        font-size: 16px;
    }

    input {
    width: 38px;
    height: 38px;
    border: none;
    text-align: center;
    font-size: 20px;
    }
    
    input:focus {
        outline: none;
        background: #e0f0ff;
    }
    
    .fixed {
        background: #ddd;
        font-weight: bold;
    }
    
    .invalid {
        background: #ffcccc;
    }
    
</style>
</head>
<body>

<h1>Satunnainen Sudoku</h1>

<p id="message" style="font-size:18px; font-weight:bold;"></p>
    
<select id="difficulty">
    <option value="easy">Helppo</option>
    <option value="medium">Keskitaso</option>
    <option value="hard">Vaikea</option>
</select>

<button onclick="generateSudoku()">Generoi</button>

<table id="sudoku"></table>

<script>
const SIZE = 9;
let grid = [];
let solution = [];

/* Utility functions */
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

function isSafe(row, col, num, board = grid) {
    for (let x = 0; x < SIZE; x++) {
        if (board[row][x] === num || board[x][col] === num) return false;
    }

    let startRow = row - row % 3;
    let startCol = col - col % 3;

    for (let r = 0; r < 3; r++) {
        for (let c = 0; c < 3; c++) {
            if (board[startRow + r][startCol + c] === num) return false;
        }
    }
    return true;
}

function fillGrid() {
    for (let row = 0; row < SIZE; row++) {
        for (let col = 0; col < SIZE; col++) {
            if (grid[row][col] === 0) {
                let numbers = shuffle([1,2,3,4,5,6,7,8,9]);
                for (let num of numbers) {
                    if (isSafe(row, col, num)) {
                        grid[row][col] = num;
                        if (fillGrid()) return true;
                        grid[row][col] = 0;
                    }
                }
                return false;
            }
        }
    }
    return true;
}

function removeNumbers(level) {
    let removals = level === "easy" ? 35 : level === "medium" ? 45 : 55;

    while (removals > 0) {
        let row = Math.floor(Math.random() * SIZE);
        let col = Math.floor(Math.random() * SIZE);
        if (grid[row][col] !== 0) {
            grid[row][col] = 0;
            removals--;
        }
    }
}

function drawGrid() {
    const table = document.getElementById("sudoku");
    table.innerHTML = "";

    for (let r = 0; r < SIZE; r++) {
        let row = document.createElement("tr");
        for (let c = 0; c < SIZE; c++) {
            let cell = document.createElement("td");

            if (grid[r][c] === 0) {
                let input = document.createElement("input");
                input.maxLength = 1;
                input.dataset.row = r;
                input.dataset.col = c;

                input.addEventListener("input", handleInput);
                cell.appendChild(input);
            } else {
                cell.textContent = grid[r][c];
                cell.classList.add("fixed");
            }

            row.appendChild(cell);
        }
        table.appendChild(row);
    }
}

function handleInput(e) {
    const input = e.target;
    const value = parseInt(input.value);
    const row = input.dataset.row;
    const col = input.dataset.col;

    input.classList.remove("invalid");

    if (!value || value < 1 || value > 9) {
        input.value = "";
        return;
    }

    if (value !== solution[row][col]) {
        input.classList.add("invalid");
    }

    checkGameStatus();
}

function checkGameStatus() {
    let inputs = document.querySelectorAll("input");
    let filled = true;

    for (let input of inputs) {
        if (input.value === "") {
            filled = false;
            break;
        }
    }

    if (!filled) return;

    for (let input of inputs) {
        let r = input.dataset.row;
        let c = input.dataset.col;
        if (parseInt(input.value) !== solution[r][c]) {
            document.getElementById("message").textContent = "âŒ VÃ¤Ã¤rÃ¤ ratkaisu. Kokeile uudestaan!";
            document.getElementById("message").style.color = "red";
            return;
        }
    }

    document.getElementById("message").textContent = "ðŸŽ‰ Onnittelut! Selvitit Sudokun!";
    document.getElementById("message").style.color = "green";
}

function generateSudoku() {
    document.getElementById("message").textContent = "";

    grid = Array.from({ length: SIZE }, () => Array(SIZE).fill(0));
    fillGrid();

    solution = grid.map(row => row.slice());

    const difficulty = document.getElementById("difficulty").value;
    removeNumbers(difficulty);
    drawGrid();
}

// Generate one on load
generateSudoku();
</script>

</body>
</html>



